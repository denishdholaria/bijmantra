# BijMantra Task Plan ‚Äî February 11, 2026

> **Session**: 97 ¬∑ **Version**: preview-1 Prathama ‚Üí preview-2  
> **Build**: ‚úÖ Passing ¬∑ 6.9 MB JS ¬∑ 423 chunks ¬∑ 8.5s  
> **Git**: `c248252` (both remotes synced)  
> **Previous plan**: `docs/tasks/20260207.md`

---

## Executive Summary

Phases 0, 1, 3, and 4 from the Feb 7 plan are **complete**. Phase 2 (frontend page wiring) was partially done ‚Äî 10 pages converted. The remaining work is:

| Category | Pages | Severity |
|----------|-------|----------|
| Frontend pages not yet wired (Phase 2 remainder) | ~31 | üî¥ Blocking preview-2 |
| Vision module API integration | 5 | üü° Pending backend deployment |
| Client-side calculators needing backend validation | 6 | üü° Quality improvement |
| Stale artifacts (metrics.json, STATE.md, CRITICAL_TODOS.md) | ‚Äî | üü† Housekeeping |
| Division pages unaudited | 106 | üü° Audit-only (no code changes expected) |

**Zero DEMO_\* arrays remain in the codebase** ‚Äî both backend and frontend are clean.

---

## Current Position (What Changed Since Feb 7)

### Completed ‚úÖ

| Phase | Task | Commit | Date |
|-------|------|--------|------|
| Phase 0 | Dead code removal (5 files) | `bbd3a7e` | Feb 7 |
| Phase 1A‚Äì1G | Backend demo eradication (all sub-tasks) | multiple | Feb 7‚Äì8 |
| Phase 2 (partial) | 10 frontend pages wired to real API | `627577f`, `4d978b4` | Feb 8 |
| Phase 3.1 | Backend smoke tests ‚Äî 1,618 passing | `12bd89c` | Feb 8 |
| Phase 3.2 | Auth guard audit ‚Äî 293 ‚Üí 0 gaps | `12bd89c` | Feb 8 |
| Phase 3.3 | E2E ‚Äî 102/102 passing | `12bd89c` | Feb 8 |
| Phase 3.4 | CI/CD ‚Äî 4 active workflows | `12bd89c` | Feb 8 |
| License v4.0 | AGPL-3.0 + geographic tiers + Apache 2.0 by 2030 | `0440b3b` | Feb 8 |
| Phase 4 | Bundle optimization ‚Äî JS 8.1 MB ‚Üí 6.9 MB (‚àí14.8%) | `c248252` | Feb 11 |

### Bundle State (Post Phase 4)

| Metric | Before | After | Change |
|--------|--------|-------|--------|
| Total JS | 8.1 MB | 6.9 MB | ‚àí14.8% |
| index chunk | 1,542 KB | 1,058 KB | ‚àí31.4% |
| ECharts chunk | 1,136 KB | 736 KB | ‚àí35.2% |
| R3F chunk | 794 KB | 794 KB | unchanged (dynamic import) |
| Vendor chunks | 1 | 10+ | split by dependency tree |

**Remaining > 500 KB**: index (1,058 KB ‚Äî app framework, irreducible), ECharts (736 KB), R3F (794 KB ‚Äî only loads for Pedigree 3D).

### What's Confirmed Clean

- **Backend**: 0 `DEMO_*` arrays, 0 hardcoded mock data. Grep matches in `field_planning.py` (refactoring comment) and `pedigree.py` (TODO comment about org_id) are false positives ‚Äî not actual demo data.
- **Frontend**: 0 `DEMO_*` imports. All 40 files matching `useState.*[]` are normal empty state initialization, not embedded demo arrays.

---

## Phase 5: Housekeeping & Artifact Update (1 session)

> **Goal**: Bring all project artifacts into sync with reality.

These files are stale and diverge from the actual codebase state. Must be fixed before any further development to avoid compounding drift.

### 5.1 Update `metrics.json`

Current (stale Feb 8 values) ‚Üí actual:

| Field | metrics.json | Reality | Action |
|-------|-------------|---------|--------|
| `frontendDemoPages` | 41 | 3 (Vision only) | Update to 3 |
| `endpointsReturningDemoData` | 41 | 0 | Update to 0 |
| `pagesWithRealApi` | 180 | ~190 | Recount |
| `bundleSize.totalJS` | "8.1 MB" | "6.9 MB" | Update |
| `bundleSize.largestChunk` | "1,542 KB" | "1,058 KB" | Update |
| `session` | 96 | 97 | Update |
| `buildTime` | "~9s" | "8.5s" | Update |

### 5.2 Update `CRITICAL_TODOS.md`

| # | Item | Status | Action |
|---|------|--------|--------|
| 1 | import_api hardcoded org | ‚úÖ Fixed (Session 94) | Remove from file |
| 2 | data_visualization stubs (5 TODOs) | üî¥ Open | Keep |
| 3 | collaboration stats hardcoded | ‚úÖ Fixed (Session 94) | Remove from file |
| 4 | GRIN integration (2 TODOs) | üî¥ Open | Keep |

### 5.3 Update `docs/CALF_STATUS.md`

- Phase 4 listed as "üî¥ Not started" ‚Üí ‚úÖ Complete (6.9 MB, 3 chunks > 500 KB)
- Update bundle numbers in Issue 3
- Update Path Forward table (P4 done)

### 5.4 Update `.kiro/steering/STATE.md`

- Session 93 ‚Üí 97
- Build: 14 MB ‚Üí 6.9 MB
- Demo data pages: 41 ‚Üí 3
- Remove resolved Known Issues (dead code, MockDashboard, chunks)
- Add Phase 4 to Recent Work

**Effort**: 30 minutes

---

## Phase 6: Frontend Page Wiring ‚Äî Remaining (4‚Äì6 sessions)

> **Goal**: Wire remaining ~31 frontend pages from Phase 2 groups (2A‚Äì2E) to real backend API.
> **Pattern**: Replace `useState([...hardcoded...])` or static displays with `useQuery` + `apiClient` fetching from `/brapi/v2/` endpoints.

### 6A. BrAPI Genotyping Pages (12 pages)

| # | Page | Route | Backend Endpoint | Difficulty |
|---|------|-------|-----------------|------------|
| 1 | Markers | `/markers` | `/brapi/v2/markers` | üü¢ Easy |
| 2 | Marker Details | `/markers/:id` | `/brapi/v2/markers/{id}` | üü¢ Easy |
| 3 | MarkerPositions | `/marker-positions` | `/brapi/v2/markerpositions` | üü¢ Easy |
| 4 | Samples | `/samples` | `/brapi/v2/samples` | üü¢ Easy |
| 5 | Sample Details | `/samples/:id` | `/brapi/v2/samples/{id}` | üü¢ Easy |
| 6 | Plates | `/plates` | `/brapi/v2/plates` | üü¢ Easy |
| 7 | References | `/references` | `/brapi/v2/references` | üü¢ Easy |
| 8 | ReferenceSets | `/referencesets` | `/brapi/v2/referencesets` | üü¢ Easy |
| 9 | Variants | `/variants` | `/brapi/v2/variants` | üü¢ Easy |
| 10 | VariantSets | `/variantsets` | `/brapi/v2/variantsets` | üü¢ Easy |
| 11 | CallSets | `/callsets` | `/brapi/v2/callsets` | üü¢ Easy |
| 12 | Vendor Orders | `/vendor-orders` | `/brapi/v2/vendor/orders` | üü° Medium |

**Pattern**: Pure BrAPI list/detail CRUD. Template approach ‚Äî wire one, replicate to remaining 11.
**Effort**: 1‚Äì2 sessions

### 6B. Breeding Domain Pages (10 pages)

| # | Page | Route | Difficulty |
|---|------|-------|------------|
| 1 | Breeding Pipeline | `/pipeline` | üü° Medium |
| 2 | Breeding Simulator | `/breeding-simulator` | üî¥ Hard (needs compute backend) |
| 3 | Breeding History | `/breeding-history` | üü¢ Easy |
| 4 | Breeding Goals | `/breeding-goals` | üü¢ Easy |
| 5 | Crossing Projects | `/crossingprojects` | üü° Medium |
| 6 | Cross Prediction | `/cross-prediction` | üî¥ Hard (Fortran kernel) |
| 7 | Parent Selection | `/parent-selection` | üü° Medium |
| 8 | Molecular Breeding | `/molecular-breeding` | üü° Medium |
| 9 | Phenomic Selection | `/phenomic-selection` | üî¥ Hard (needs ML backend) |
| 10 | Disease Resistance | `/disease-resistance` | üü¢ Easy |

**Pattern**: Mix of list views (wire to DB) and computational views (need algorithm backend).
**Effort**: 3‚Äì4 sessions

### 6C. Genomics Advanced Pages (5 pages)

| # | Page | Route | Compute Engine | Difficulty |
|---|------|-------|---------------|------------|
| 1 | Genomic Selection | `/genomic-selection` | Fortran BLUP/REML | üî¥ Hard |
| 2 | Population Genetics | `/population-genetics` | Rust/WASM | üü° Medium |
| 3 | Parentage Analysis | `/parentage-analysis` | Pedigree service | üü° Medium |
| 4 | Marker Assisted Selection | `/marker-assisted-selection` | Mixed | üü° Medium |
| 5 | Bioinformatics | `/bioinformatics` | Client-side algorithms | üü° Medium |

**Pattern**: Requires connecting Fortran/Rust compute engines to API, then API to frontend.
**Effort**: 3‚Äì4 sessions

### 6D. Analytics & Environment Pages (5 pages)

| # | Page | Route | Compute Engine | Difficulty |
|---|------|-------|---------------|------------|
| 1 | GxE Interaction | `/gxe-interaction` | Fortran `gxe_analysis.f90` | üî¥ Hard |
| 2 | Stability Analysis | `/stability-analysis` | Fortran `stability_analysis.f90` | üî¥ Hard |
| 3 | Trial Network | `/trial-network` | DB + network viz | üü° Medium |
| 4 | Data Quality | `/dataquality` | Backend validation | üü¢ Easy |
| 5 | Data Validation | `/data-validation` | Backend validation | üü¢ Easy |

**Pattern**: GxE + Stability have Fortran kernels ready. Others need backend queries.
**Effort**: 2 sessions

### 6E. Pedigree & Other Pages (9 pages)

| # | Page | Route | Difficulty |
|---|------|-------|------------|
| 1 | Pedigree 3D | `/pedigree-3d` | üü° Medium (R3F + API) |
| 2 | Pedigree Viewer | `/pedigree` | üü¢ Easy (service exists) |
| 3 | Pedigree Analysis | `/pedigree-analysis` | üü° Medium |
| 4 | Progeny | `/progeny` | üü¢ Easy |
| 5 | Sample Tracking | `/sample-tracking` | üü° Medium |
| 6 | Speed Breeding | `/speed-breeding` | üü¢ Easy |
| 7 | Doubled Haploid | `/doubled-haploid` | üü¢ Easy |
| 8 | Abiotic Stress | `/abiotic-stress` | üü¢ Easy |
| 9 | Phenology Tracker | `/phenology-tracker` | üü° Medium |

**Pattern**: Pedigree backend service exists (`pedigree.py`). Others need DB schemas + seeders.
**Effort**: 2‚Äì3 sessions

---

## Phase 7: Vision Module Integration (2‚Äì3 sessions)

> **Goal**: Connect 5 Vision pages to backend image analysis API.

| # | Page | Current State | Required Backend |
|---|------|--------------|-----------------|
| 1 | VisionDashboard | UI only, no `apiClient` import | `/brapi/v2/images` summary endpoint |
| 2 | VisionAnnotate | UI only, no `apiClient` import | `/brapi/v2/images/{id}/annotations` |
| 3 | VisionRegistry | UI only, no `apiClient` import | `/brapi/v2/images` + model registry |
| 4 | VisionDatasets | UI only, no `apiClient` import | Image dataset CRUD |
| 5 | VisionTraining | UI only, no `apiClient` import | Training job management |

**Note**: `PlantVision.tsx` is already wired (`useQuery` + `apiClient`). These 5 are the ML management pages that need the Vision backend service deployed first.

**Dependencies**:
- Backend: Image analysis service (OpenCV, model serving)
- Storage: MinIO for image assets (already configured)
- DB: Vision-related tables (partially exist via BrAPI `/images` endpoint)

**Effort**: 2‚Äì3 sessions (1 for backend endpoints, 1‚Äì2 for frontend wiring)

---

## Phase 8: Client-Side Calculator Backend Validation (2 sessions)

> **Goal**: Add backend validation + persistence for 6 calculator pages.

| # | Page | Current | Target |
|---|------|---------|--------|
| 1 | FertilizerCalculator | Client-only math | Backend validation + save results |
| 2 | TraitCalculator | Client-only math | Backend validation + save results |
| 3 | CostAnalysis | Client-only math | Backend validation + save results |
| 4 | ResourceAllocation | Client-only math | Backend validation + save results |
| 5 | YieldMap | Client-only rendering | Backend spatial query + save |
| 6 | GrowthTracker | Client-only charts | Backend time-series persistence |

**Pattern**: These work today (CALF-1) but lack audit trail and persistence. Not blocking preview-2 but needed for production.

**Effort**: 2 sessions

---

## Phase 9: CALF Re-Assessment (1 session)

> **Goal**: Fresh audit of all 354 pages with corrected CALF levels.

| # | Task | Effort |
|---|------|--------|
| 9.1 | Audit 106 division pages | 1 session |
| 9.2 | Re-audit former CALF-2 pages (all should be CALF-3+) | 30 min |
| 9.3 | Regenerate CALF_STATUS.md | 30 min |
| 9.4 | Update metrics.json final numbers | 15 min |

---

## Phase 10: CRITICAL_TODOS Resolution (1‚Äì2 sessions)

> **Goal**: Close the 2 remaining open items.

### 10.1 Data Visualization Stubs (5 TODOs)

```
backend/app/api/v2/data_visualization.py ‚Äî 5 TODO items
```

These are stub endpoints that return placeholder responses. Need real query implementations.

### 10.2 GRIN Integration (2 TODOs)

```
backend/app/api/v2/grin_integration.py ‚Äî 2 TODO items
```

External API integration with USDA GRIN database. Requires GRIN API key and rate limiting.

---

## Timeline (Feb 11 ‚Üí preview-2)

```
Session 97  (Feb 11)   ‚ñê‚ñà‚ñà‚ñå Phase 5 (Housekeeping) ‚Äî THIS SESSION
Session 98  (Feb 12)   ‚ñê‚ñà‚ñà‚ñà‚ñà‚ñå Phase 6A (BrAPI Genotyping ‚Äî 12 pages, template approach)
Session 99  (Feb 13)   ‚ñê‚ñà‚ñà‚ñà‚ñà‚ñå Phase 6A completion + Phase 6E start (Pedigree)
Session 100 (Feb 14)   ‚ñê‚ñà‚ñà‚ñà‚ñà‚ñå Phase 6B (Breeding Domain ‚Äî 10 pages)
Session 101 (Feb 15)   ‚ñê‚ñà‚ñà‚ñà‚ñà‚ñå Phase 6B completion + Phase 6D (Analytics)
Session 102 (Feb 16)   ‚ñê‚ñà‚ñà‚ñà‚ñà‚ñå Phase 6C (Genomics Advanced ‚Äî compute engine wiring)
Session 103 (Feb 17)   ‚ñê‚ñà‚ñà‚ñà‚ñà‚ñå Phase 6C completion + Phase 7 start (Vision)
Session 104 (Feb 18)   ‚ñê‚ñà‚ñà‚ñà‚ñà‚ñå Phase 7 completion + Phase 9 (CALF audit)
Session 105 (Feb 19)   ‚ñê‚ñà‚ñà‚ñà‚ñà‚ñå Phase 8 (Calculator backends) + Phase 10 (CRITICAL_TODOS)
Session 106 (Feb 20)   ‚ñê‚ñà‚ñà‚ñå preview-2 release candidate ‚Äî final verification
```

**Estimated sessions to preview-2**: ~10 sessions (Sessions 97‚Äì106)

---

## Success Criteria for preview-2

| Criterion | Feb 7 Target | Feb 11 Actual | preview-2 Target |
|-----------|-------------|---------------|------------------|
| Demo data pages | 0 | 3 (Vision, pending API) | 0 |
| Backend demo violators | 0 | **0 ‚úÖ** | 0 |
| Dead code files | 0 | **0 ‚úÖ** | 0 |
| Test coverage (E2E) | 100 tests | **102 ‚úÖ** | ‚â• 150 tests |
| Largest chunk | < 500 KB | 1,058 KB (irreducible) | < 1,100 KB |
| Total bundle JS | < 10 MB | **6.9 MB ‚úÖ** | < 7 MB |
| CALF audit coverage | 354/354 | 248/354 | 354/354 |
| Pages with real API | 180+ | ~190 | 220+ |
| CRITICAL_TODOS open | ‚Äî | 2 | 0 |
| Smoke tests | 1,618 | **1,618 ‚úÖ** | ‚â• 1,700 |
| Zero Mock Data Policy | Full | **Backend: Full ‚úÖ** | Full (front + back) |

---

## Priority Order (Execution Sequence)

```
P0 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà Phase 5  ‚Äî Housekeeping (metrics.json, STATE.md, CRITICAL_TODOS.md, CALF_STATUS.md)
P1 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà Phase 6A ‚Äî BrAPI Genotyping (12 pages, template, highest ROI)
P2 ‚ñà‚ñà‚ñà‚ñà   Phase 6E ‚Äî Pedigree & Other (9 pages, backend exists)
P3 ‚ñà‚ñà‚ñà‚ñà   Phase 6B ‚Äî Breeding Domain (10 pages, mixed difficulty)
P4 ‚ñà‚ñà‚ñà    Phase 6D ‚Äî Analytics & Environment (5 pages, Fortran kernels)
P5 ‚ñà‚ñà‚ñà    Phase 6C ‚Äî Genomics Advanced (5 pages, compute engines)
P6 ‚ñà‚ñà     Phase 7  ‚Äî Vision Module (5 pages, needs backend deployment)
P7 ‚ñà‚ñà     Phase 9  ‚Äî CALF Re-Assessment (audit only)
P8 ‚ñà      Phase 8  ‚Äî Calculator Backend Validation (quality, not blocking)
P9 ‚ñà      Phase 10 ‚Äî CRITICAL_TODOS Resolution (maintenance)
```

---

## Risk Register (Updated)

| Risk | Likelihood | Impact | Mitigation |
|------|-----------|--------|------------|
| Phase 6A template doesn't generalize | Low | Medium | Verify with 2 pages before batch apply |
| Compute engine wiring (6C, 6D) takes longer than estimated | High | Medium | Defer to post-preview-2 if needed |
| Vision backend not ready for Phase 7 | Medium | Low | Mark as "pending" in CALF, don't block release |
| Division audit (Phase 9) reveals new issues | Medium | Low | Expected ‚Äî audit surfaces truth |
| DB seeders missing for demo org | Medium | High | Verify seed data before each phase |
| metrics.json drift if not updated per session | High | Medium | Update as Phase 5 step, enforce per-session |

---

## Reference: Compute Engine Readiness

### Fortran Kernels (9 files) ‚Äî Ready, need API wiring

| Kernel | File | Needed By Phase |
|--------|------|----------------|
| BLUP Solver | `blup_solver.f90` | 6C (Genomic Selection) |
| REML Engine | `reml_engine.f90` | 6C (Genomic Selection) |
| Kinship | `kinship.f90` | 6C (Population Genetics) |
| GxE Analysis | `gxe_analysis.f90` | 6D (GxE Interaction) |
| Stability Analysis | `stability_analysis.f90` | 6D (Stability Analysis) |
| LD Analysis | `ld_analysis.f90` | 6C (via WASM) |
| PCA/SVD | `pca_svd.f90` | 6C (Population structure) |
| Selection Index | `selection_index.f90` | 6C (Multi-trait selection) |

### Rust/WASM (9 files) ‚Äî Compiled, need frontend hooks

| Module | File | Needed By Phase |
|--------|------|----------------|
| Genomics | `genomics.rs` | 6C |
| Matrix (GRM) | `matrix.rs` | 6C |
| Statistics | `statistics.rs` | 6C, 6D |
| Population | `population.rs` | 6C |
| Sequence | `sequence.rs` | 6C |

---

## Session Log

| Session | Date | Phase | Work Done | Commit |
|---------|------|-------|-----------|--------|
| 93 | Feb 7 | 0, 1A‚Äì1D | Dead code + backend demo eradication | `bbd3a7e` |
| 94 | Feb 7 | 1E‚Äì1G | Backend security + stubs | multiple |
| 95 | Feb 8 | 2 (partial), 3 | 10 pages wired + testing foundation | `627577f`‚Äì`12bd89c` |
| 96 | Feb 8 | 5 (partial) | CALF consolidation + License v4.0 | `0440b3b` |
| 97 | Feb 11 | 4, 5 | Bundle optimization + plan creation | `c248252` |

---

*This plan supersedes `docs/tasks/20260207.md` for all remaining work.*  
*Source of truth: `metrics.json` ¬∑ State: `.kiro/steering/STATE.md`*  
*Date: February 11, 2026 ¬∑ Session 97*
